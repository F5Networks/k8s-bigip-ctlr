apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: policies.cis.f5.com
spec:
  group: cis.f5.com
  names:
    kind: Policy
    shortNames:
      - plc
    singular: policy
    plural: policies
  scope: Namespaced
  versions:
    -
      name: v1
      served: true
      storage: true
      schema:
        openAPIV3Schema:
          type: object
          properties:
            spec:
              type: object
              properties:
                l7Policies:
                  type: object
                  properties:
                    waf:
                      type: string
                      pattern: '^\/([A-z0-9-_+]+\/)+([A-z0-9]+\/?)*$'
                l3Policies:
                  type: object
                  properties:
                    dos:
                      type: string
                      pattern: '^\/([A-z0-9-_+]+\/)+([A-z0-9]+\/?)*$'
                    firewall:
                      type: string
                      pattern: '^\/([A-z0-9-_+]+\/)+([A-z0-9]+\/?)*$'
                ltmPolicies:
                  type: object
                  properties:
                    insecure:
                      type: string
                      pattern: '^\/([A-z0-9-_+]+\/)+([A-z0-9]+\/?)*$'
                    secure:
                      type: string
                      pattern: '^\/([A-z0-9-_+]+\/)+([A-z0-9]+\/?)*$'
                    priority:
                      type: string
                      enum: [low, high]
                iRules:
                  type: object
                  properties:
                    insecure:
                      type: string
                      pattern: '^\/([A-z0-9-_+]+\/)+([A-z0-9]+\/?)*$'
                    secure:
                      type: string
                      pattern: '^\/([A-z0-9-_+]+\/)+([A-z0-9]+\/?)*$'
                    priority:
                      type: string
                      enum: [ low, high ]
                profiles:
                  type: object
                  properties:
                    tcp:
                      type: string
                      pattern: '^\/([A-z0-9-_+]+\/)+([A-z0-9]+\/?)*$'
                    udp:
                      type: string
                      pattern: '^\/([A-z0-9-_+]+\/)+([A-z0-9]+\/?)*$'
                    http:
                      type: string
                      pattern: '^\/([A-z0-9-_+]+\/)+([A-z0-9]+\/?)*$'
                    rewriteProfile:
                      type: string
                      pattern: '^\/([A-z0-9-_+]+\/)+([A-z0-9]+\/?)*$'
